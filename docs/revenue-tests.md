# Тесты Модели Распределения Доходов

Этот документ описывает тесты, используемые для проверки точности и эффективности нашей модели распределения доходов.

## Описание Тестов

Мы используем два типа тестов для проверки модели распределения доходов:

1. **Браузерный тест**: Работает в браузере, используя функцию `runTestSimulation()` в классе `RevenueCalculator`.
2. **Node.js тест**: Более мощный тест, работающий непосредственно на сервере, сохраняющий результаты в JSON-файлы. Использует `RevenueTestSimulator` из `revenue-test-node.js`.

### Параметры для Тестирования

По умолчанию оба теста используют следующие параметры:

- **Начальная инвестиция**: 100,000
- **Цена токена**: 100
- **Количество Заказчиков**: 1,000 (вычисляется как `ceil(100,000 / 100)`)
- **Распределение дохода**:
  - Создатель: 10%
  - Платформа: 10%
  - Продвижение: 10%
  - Покупатели: 70% (остаток)
- **Модель окупаемости**:
  - Неокупившийся пул (эксклюзивный): 60% от доли покупателей
  - Общий пул: 40% от доли покупателей
- **Коэффициенты окупаемости**: 1x, 2x, 3x (где nх = цель вернуть n раз вложенную сумму)
- **Отслеживаемые токены**: #1, #100, #1000

## Запуск Node.js Теста

Для запуска полного теста с Node.js (рекомендуется):

1. Убедитесь, что у вас установлен Node.js (версия 14 или выше)
2. Откройте командную строку в корневой директории проекта
3. Запустите тест командой:

```bash
node js/revenue-test-node.js
```

Тест будет выполняться поэтапно:
- Сначала он симулирует продажи для коэффициента окупаемости 1x
- Затем для 2x и 3x
- Результаты будут сохранены в директорию `revenue-test-results/`

## Интерпретация Результатов

Тест показывает:
1. На какой продаже (номер сделки) каждый из отслеживаемых токенов (#1, #100, #1000) достигает окупаемости
2. Накопленный доход всех первых 100 токенов после каждой партии в 1000 продаж

В конце теста будет выведена таблица с итоговыми результатами, подобной этой:

```
=== SUMMARY REPORT ===
Token   | 1x Payback | 2x Payback | 3x Payback
------------------------------------------------------
Token #1    | 2468      | 8976      | 15784
Token #100  | 2563      | 9048      | 15912
Token #1000 | 3011      | 9752      | 16890
```

Где числа показывают номер продажи, при которой токен достиг цели окупаемости.

## Внутренняя Работа Теста

Тест работает следующим образом:

1. **Покупатели с #1 по #1000**: Подпадают под фазу предоплаты (их платежи идут напрямую создателю).
2. **Продажи начиная с #1001**: Моделируются по формуле распределения:
   - 70% от каждой продажи идет на распределение между предыдущими токенами.
   - 60% из этих 70% идет исключительно неокупившимся токенам.
   - 40% из 70% распределяется поровну между всеми предыдущими токенами.
3. **Отслеживание окупаемости**: Для каждого токена отслеживается его накопленный доход.
4. **Динамическая смена группы**: Когда токен достигает цели окупаемости (1x, 2x или 3x от цены), он переходит из группы неокупившихся в группу окупившихся токенов, получая меньшую долю в будущих распределениях.

Результат демонстрирует эффективность модели в обеспечении возврата инвестиций различных держателей токенов. 