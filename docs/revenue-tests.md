# Тесты распределения доходов

## Типы тестов

Мы используем два типа тестов для анализа модели распределения доходов:

1. **Браузерные тесты** - работают в интерактивном калькуляторе, позволяют быстро моделировать доходы от продаж и проверять работу модели.
2. **Node.js тесты** - автономные тесты, которые можно запускать в среде Node.js для моделирования больших объемов продаж и долгосрочных результатов.

## Параметры тестирования

Все тесты используют следующие основные параметры:

- **Начальные инвестиции**: Сумма, внесенная автором проекта (по умолчанию: 10000)
- **Цена токена**: Цена продажи каждого токена (по умолчанию: 100)
- **Количество заказчиков**: Количество токенов, проданных в фазе предоплаты, вычисляется как `Math.ceil(Начальные инвестиции / Цена токена)`
- **Распределение доходов**:
  - Доля автора: 20%
  - Доля платформы: 5%  
  - Доля продвижения: 5%
  - Доля покупателей: 70%
- **Модель окупаемости**:
  - Коэффициенты окупаемости: 1 (100%), 2 (200%), 3 (300%)
  - Процент в пул неокупившихся: 95%
  - Процент в общий пул: 5%

## Запуск Node.js теста

Для запуска автономного теста в Node.js:

1. Перейдите в корневую директорию проекта
2. Выполните команду:

```bash
node js/revenue-test-node.js
```

Вы также можете передать свои параметры:

```bash
node js/revenue-test-node.js --investment=10000 --tokenPrice=100 --paybackRatios=1,2,3
```

## Формат результатов

Результаты теста сохраняются в директорию `test-results/` в следующих форматах:

1. **Данные по партиям**: Файлы с префиксом `batch_` содержат детальную информацию о токенах, достигших окупаемости в каждой партии.
2. **Итоговый отчет**: Файл `summary_report.txt` содержит сводную информацию о результатах всех тестов.

### Формат итогового отчета

```
=================================
SUMMARY REPORT - REVENUE DISTRIBUTION TEST
=================================
Parameters:
- Initial Investment: 10000
- Token Price: 100
- Number of Prepayers: 100
- Creator Share: 20%
- Platform Share: 5%
- Promotion Share: 5%
- Buyers Share: 70%
- Non-Payback Pool: 95%

---------------------------------
TOKEN PAYBACK RESULTS
---------------------------------
**Параметры: 60% для неокупившихся, 40% для всех**

Token #    | 1x Payback | 2x Payback | 3x Payback
-----------|------------|------------|------------
#1         | 4172       | 17404      | 72619
#100       | 4172       | 17404      | 72619
#1000      | 4172       | 17404      | 72619

**Параметры: 95% для неокупившихся, 5% для всех**

Token #    | 1x Payback | 2x Payback | 3x Payback
-----------|------------|------------|------------
#1         | 416        | 1733       | 7230
#100       | 416        | 1733       | 7230
#1000      | 2483       | 15207      | 70427

---------------------------------
ФИНАНСОВЫЕ ПОКАЗАТЕЛИ В ТОЧКАХ ОКУПАЕМОСТИ
---------------------------------
**Параметры: 95% для неокупившихся, 5% для всех**

Token #1:
  1x Payback (продажа #416):
    Всего собрано: 41 600
    Выплачено автору: 13 160
    Выплачено платформе: 3 160
  2x Payback (продажа #1733):
    Всего собрано: 173 300
    Выплачено автору: 26 330
    Выплачено платформе: 16 330
  3x Payback (продажа #7230):
    Всего собрано: 723 000
    Выплачено автору: 81 300
    Выплачено платформе: 71 300

Token #100:
  1x Payback (продажа #416):
    Всего собрано: 41 600
    Выплачено автору: 13 160
    Выплачено платформе: 3 160
  2x Payback (продажа #1733):
    Всего собрано: 173 300
    Выплачено автору: 26 330
    Выплачено платформе: 16 330
  3x Payback (продажа #7230):
    Всего собрано: 723 000
    Выплачено автору: 81 300
    Выплачено платформе: 71 300

Token #1000:
  1x Payback (продажа #2483):
    Всего собрано: 248 300
    Выплачено автору: 33 830
    Выплачено платформе: 23 830
  2x Payback (продажа #15207):
    Всего собрано: 1 520 700
    Выплачено автору: 161 070
    Выплачено платформе: 151 070
  3x Payback (продажа #70427):
    Всего собрано: 7 042 700
    Выплачено автору: 713 270
    Выплачено платформе: 703 270
```

## Интерпретация результатов

Результаты тестов дают важную информацию о поведении модели распределения доходов:

1. **Влияние параметров распределения**: 
   - При высоком проценте для неокупившихся (95%) ранние токены получают значительное преимущество
   - При низком проценте для неокупившихся (60%) все токены достигают окупаемости одновременно
   - Изменяя баланс между двумя пулами, можно тонко настраивать справедливость распределения

2. **Влияние коэффициентов окупаемости**:
   - Для достижения 2x окупаемости требуется примерно в 4-6 раз больше продаж, чем для 1x
   - Для достижения 3x окупаемости требуется примерно в 15-30 раз больше продаж, чем для 1x
   - Ярко выраженная нелинейность отражает особенности функционирования системы распределения

3. **Разрыв между ранними и поздними токенами**:
   - При высоком проценте для неокупившихся (95%) разрыв составляет примерно 2000 продаж для 1x и увеличивается до 63000 для 3x
   - При низком проценте для неокупившихся (60%) разрыв отсутствует полностью

4. **Выбор оптимальных параметров**:
   - Выбор между быстрой окупаемостью ранних токенов и равными условиями для всех
   - Возможность настройки под различные бизнес-модели и требования справедливости
   - Рекомендуется выбирать параметры в диапазоне 70-90% для неокупившихся как баланс между справедливостью и эффективностью

5. **Финансовые показатели в точках окупаемости**:
   - Наблюдается экспоненциальный рост общей суммы сбора с увеличением коэффициента окупаемости
   - Для достижения 1x окупаемости ранних токенов (#1, #100) требуется собрать около 41 600, тогда как для 3x нужно уже 723 000
   - Для окупаемости поздних токенов (#1000) требуются значительно большие объемы сбора: 248 300 для 1x и более 7 миллионов для 3x
   - С ростом общего сбора пропорционально увеличиваются выплаты автору и платформе

6. **Соотношение выплат**:
   - В ранних точках окупаемости автор получает значительно больше платформы за счет начальных инвестиций
   - По мере роста числа продаж, выплаты платформе и автору становятся почти одинаковыми
   - При высоких значениях (например, 70 тыс. продаж) большая часть собранных средств (более 80%) распределяется между участниками

## Результаты тестов для токенов

### Сводный отчет

#### Параметры теста
- Начальные инвестиции: 10,000
- Цена токена: 100
- Количество препейеров: 100 
- Доля создателя: 10%
- Доля платформы: 10%
- Доля на продвижение: 0%
- Доля покупателям: 80%

#### Результаты для окупаемости токенов (95% для нераскупившихся токенов)

| Токен   | Продажи для 1x окупаемости | Продажи для 2x окупаемости | Продажи для 3x окупаемости |
|---------|----------------------------|----------------------------|----------------------------|
| #1      | 416                        | 1,733                      | 7,230                      |
| #100    | 416                        | 1,733                      | 7,230                      |
| #1000   | 2,483                      | 15,207                     | 70,427                     |

#### Финансовые показатели на момент окупаемости (95% для нераскупившихся токенов)

##### Ранние токены (#1, #100) - Финансовые показатели
| Показатель | 1x окупаемость | 2x окупаемость | 3x окупаемость |
|------------|----------------|----------------|----------------|
| Всего собрано | 41,600 | 173,300 | 723,000 |
| Выплачено автору | 14,160 + 10,000* = 24,160 | 17,330 + 10,000* = 27,330 | 81,300 + 10,000* = 91,300 |
| Выплачено платформе | 4,160 (10%)† | 17,330 (10%)† | 71,300 (9.9%)† |

*10,000 - сумма начальных инвестиций (предоплата), полностью выплаченная автору.
†Процент от дохода после предоплаты (не от общего дохода)

##### Поздние токены (#1000) - Финансовые показатели
| Показатель | 1x окупаемость | 2x окупаемость | 3x окупаемость |
|------------|----------------|----------------|----------------|
| Всего собрано | 248,300 | 1,520,700 | 7,042,700 |
| Выплачено автору | 34,830 + 10,000* = 44,830 | 161,070 + 10,000* = 171,070 | 713,270 + 10,000* = 723,270 |
| Выплачено платформе | 24,830 (10%)† | 151,070 (10%)† | 703,270 (10%)† |

*10,000 - сумма начальных инвестиций (предоплата), полностью выплаченная автору.
†Процент от дохода после предоплаты (не от общего дохода)

#### Результаты для окупаемости токенов (60% для нераскупившихся токенов)

| Токен   | Продажи для 1x окупаемости | Продажи для 2x окупаемости | Продажи для 3x окупаемости |
|---------|----------------------------|----------------------------|----------------------------|
| #1      | 665                        | 3,975                      | 23,851                     |
| #100    | 665                        | 3,975                      | 23,851                     |
| #1000   | 665                        | 3,975                      | 23,851                     |

#### Финансовые показатели на момент окупаемости (60% для нераскупившихся токенов)

##### Токены (#1, #100, #1000) - Финансовые показатели
| Показатель | 1x окупаемость | 2x окупаемость | 3x окупаемость |
|------------|----------------|----------------|----------------|
| Всего собрано | 66,500 | 397,500 | 2,385,100 |
| Выплачено автору | 16,650 + 10,000* = 26,650 | 49,750 + 10,000* = 59,750 | 248,510 + 10,000* = 258,510 |
| Выплачено платформе | 6,650 (10%)† | 39,750 (10%)† | 238,510 (10%)† |

*10,000 - сумма начальных инвестиций (предоплата), полностью выплаченная автору.
†Процент от дохода после предоплаты (не от общего дохода)

### Интерпретация результатов

Анализ финансовых показателей в ключевых точках окупаемости выявляет несколько важных аспектов модели распределения доходов:

1. **Экспоненциальный рост общего дохода**
   - Заметен значительный рост общего собранного дохода при увеличении коэффициента окупаемости
   - Для достижения 3x окупаемости требуется в 5-10 раз больше продаж, чем для 1x

2. **Динамика выплат создателю и платформе**
   - На ранних этапах (1x окупаемость) доля создателя заметно выше из-за начальных инвестиций (предоплаты в размере 10,000)
   - С ростом продаж выплаты создателю и платформе от последующих продаж выравниваются и приближаются к установленным процентам распределения
   - Платформа получает 10% только от продаж ПОСЛЕ фазы предоплаты, поэтому её доход не равен 10% от общего сбора (общий сбор включает предоплату, которая полностью идёт автору)

3. **Разница в требуемых продажах**
   - При высокой доле для нераскупившихся токенов (95%) поздние токены требуют значительно большего количества продаж для достижения тех же целей окупаемости
   - При сбалансированной доле (60%) все токены окупаются одновременно

4. **Влияние параметров распределения**
   - Параметр nonPaybackPoolSharePercent имеет решающее значение для скорости окупаемости
   - Более высокое значение (95%) ускоряет окупаемость ранних токенов за счет поздних
   - Более низкое значение (60%) создает равные условия, но замедляет общую скорость окупаемости для всех

5. **Фактический процент платформы от общего дохода**
   - При 1x окупаемости ранних токенов: 4,160 / 41,600 = 10% (от дохода после предоплаты)
   - При 3x окупаемости поздних токенов: 703,270 / 7,042,700 ≈ 10%
   - Доля платформы от общего дохода (включая предоплату) всегда немного меньше установленного процента, но с ростом продаж приближается к нему
   - При очень больших объемах продаж доля платформы стремится к заданным 10%, так как влияние предоплаты становится незначительным

Для баланса между скоростью окупаемости и справедливостью распределения рекомендуется устанавливать значение nonPaybackPoolSharePercent в диапазоне 70-90% в зависимости от конкретных целей проекта.

## Исходный код теста

Исходный код теста находится в файле [js/revenue-test-node.js](../js/revenue-test-node.js) и содержит класс `RevenueTestSimulator`, который выполняет все необходимые вычисления и сохраняет результаты. 