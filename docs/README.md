# Документация проекта Buy-to-Earn

## Обзор
Проект Buy-to-Earn представляет собой платформу для групповых заказов с использованием эскроу-функциональности, обеспечивающей безопасные сделки между заказчиками и исполнителями. Платформа позволяет:
- Создавать групповые заказы с определением этапов работы
- Подключаться к групповым заказам, внося свою долю средств
- Выбирать представителя среди участников заказа
- Контролировать выполнение работ по этапам
- Проверять качество работы и подписывать акты выполненных работ

## Структура документации
- [Архитектура проекта](architecture.md)
- [Эскроу-функциональность](escrow.md)
- [Система уведомлений](notifications.md)
- [Локальная разработка](local-development.md)
- [API и серверная часть](api.md)
- [Безопасность](security.md)

## Структура проекта
```
/
├── index.html       # Основной HTML-файл приложения
├── styles/          # CSS-стили
│   ├── main.css     # Основные стили
│   └── escrow.css   # Стили для эскроу-компонентов
├── js/              # JavaScript файлы
│   ├── local-auth.js       # Локальная авторизация
│   ├── db.js               # Взаимодействие с базой данных
│   └── escrow/            # Модули для эскроу-функциональности
│       ├── constants.js    # Константы и перечисления
│       ├── models.js       # Модели данных
│       ├── local-storage.js # Локальное хранилище
│       ├── application.js  # Основная логика
│       ├── ui.js           # Интерфейс пользователя
│       └── index.js        # Точка входа для эскроу-модуля
└── docs/            # Документация проекта
    ├── README.md    # Обзор документации
    └── ...          # Другие файлы документации
```

## Технологии
- HTML5, CSS3, JavaScript
- Firebase (Firestore) для хранения данных
- Firebase Authentication для аутентификации
- LocalStorage для локальной разработки

## Установка и запуск
Для локальной разработки:
1. Клонировать репозиторий
2. Открыть index.html в браузере (для полноценной работы некоторых API может потребоваться локальный сервер)

Для тестирования отдельных компонентов:
- `test-notifications.html` - тестирование системы уведомлений

## Особенности проекта
- Модульная архитектура с возможностью расширения
- Поддержка локальной разработки без обязательного подключения к серверу
- Система уведомлений для интерактивного взаимодействия с пользователем
- Эскроу-функциональность для обеспечения безопасности сделок 

## Обновление: Опциональный выбор исполнителя

В последнем обновлении была добавлена функциональность создания групповых заказов без указания исполнителя. Это позволяет пользователям создавать групповые заказы даже при отсутствии доступных исполнителей в системе.

### Изменения:
1. Поле выбора исполнителя (contractor) теперь опциональное при создании заказа
2. Добавлен соответствующий перевод для интерфейса на русском, английском и испанском языках
3. Модифицирована бизнес-логика для корректной работы заказов без исполнителя

### Как это работает:
- Пользователь может создать заказ без выбора исполнителя
- Такой заказ будет находиться в статусе PENDING, пока не назначен исполнитель
- Исполнитель может быть назначен позже администратором или через голосование представителей

### Ограничения:
- Для заказов без исполнителя невозможно отметить этапы как выполненные, пока исполнитель не будет назначен
- Все остальные функции (сбор средств, голосование за представителя и т.д.) доступны без ограничений 

## Обновление интерфейса

В интерфейс были внесены следующие изменения для унификации и упрощения взаимодействия пользователя с системой:

### Унификация создания заказов
1. Удалена отдельная кнопка "Создать групповой заказ", так как в системе все заказы являются групповыми
2. Существующая форма создания заказа на вкладке "Submit Order" была модифицирована для использования эскроу-функциональности
3. Форма обновлена для работы с этапами (milestones) и выбором опционального исполнителя

### Управление фондами
1. Функциональность управления фондами перенесена в раздел "Кошелек" (Wallet)
2. Добавлена возможность пополнения эскроу-баланса из кошелька
3. Кнопка с балансом в шапке сайта теперь также открывает модальное окно пополнения счета
4. Баланс эскроу-аккаунта отображается как в разделе портфолио, так и в кошельке

### Преимущества модификации
- Упрощение интерфейса путем устранения дублирования функциональности
- Более интуитивное размещение функций управления средствами в разделе "Кошелек"
- Единый процесс создания заказов, понятный пользователю
- Более четкое разделение функциональности по соответствующим разделам сайта 

## Последние обновления

### Обновление интерфейса заказов и улучшение UX (2023-04-xx)

#### Что обновлено
- Исправлены проблемы с дублированием уведомлений при создании заказа
- Добавлена проверка на положительную сумму этапа (milestone) при создании заказа
- Улучшен внешний вид карточек заказов в маркетплейсе
- Добавлена корректная локализация заголовков разделов для всех поддерживаемых языков (RU, EN, ES)
- Улучшена функциональность участия в заказах для других пользователей
- Добавлены кнопки "Участвовать" для присоединения к групповым заказам

#### Как это работает
1. **Создание заказа**
   - При создании заказа система проверяет, что все суммы этапов положительные
   - Валидация предотвращает создание заказа с некорректными данными
   - Пользователь получает четкие сообщения об ошибках на своем языке

2. **Отображение заказов**
   - Заказы разделены на две категории: "Ваши заказы" и "Все активные заказы"
   - Добавлены стили и анимации для улучшения пользовательского опыта
   - Карточки заказов содержат всю необходимую информацию и кнопки для действий

3. **Участие в заказах**
   - Любой авторизованный пользователь может присоединиться к заказу через кнопку "Участвовать"
   - При нажатии открывается модальное окно для внесения средств
   - После успешного участия пользователь становится соинвестором заказа

4. **Исполнение заказов**
   - Исполнители могут брать заказы на исполнение при наличии достаточного количества средств
   - При выполнении этапов работы средства автоматически переводятся исполнителю
   - Заказчики могут отслеживать прогресс выполнения заказа

#### Технические детали
- Улучшен процесс валидации форм создания заказа
- Добавлены обработчики событий для кнопок участия и просмотра деталей
- Исправлены проблемы с локализацией и отображением текста на разных языках
- Оптимизирован процесс создания и отображения карточек заказов

#### Ограничения
- Для участия в заказе необходима авторизация в системе
- Сумма участия должна быть положительной и не превышать баланс пользователя
- Исполнитель должен быть зарегистрирован в системе как подрядчик 